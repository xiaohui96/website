webpackJsonp([29],{hJOE:function(t,e){},yaR9:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("FWN/"),s={data:function(){return{fn:new i.a,DeviceStateAnalysis:null,AlarmRanking:null,WeekAlarmTypeAnalysis:null,TopOfflineChats:null,TopAlarmCharts:null,TopOffline:"",TopAlarm:""}},mounted:function(){var t=this.getQueryString("token"),e=this.getQueryString("usertype");t&&(console.log("从管理员账号打开"),sessionStorage.setItem("token",t),sessionStorage.setItem("usertype",e)),this.drawDevice(),this.drawWeek(),this.drawType();var a=this;$(window).on("resize",function(){a.DeviceStateAnalysis.resize(),a.AlarmRanking.resize(),a.WeekAlarmTypeAnalysis.resize(),a.TopOfflineChats.resize(),a.TopAlarmCharts.resize()})},methods:{getQueryString:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),a=window.location.search.substr(1).match(e);return null!=a?unescape(a[2]):null},drawDevice:function(){var t=this,e=sessionStorage.getItem("token");this.DeviceStateAnalysis=echarts.init(document.getElementById("DeviceStateAnalysis")),this.DeviceStateAnalysis.showLoading(),this.fn.GetDeviceState(e).then(function(e){var a=JSON.parse(e);if("0"==a.code){var i=a.info,s={backgroundColor:"#fff",title:{text:"当前电气火灾设备状态分析",padding:[15,20,0,40],textStyle:{color:"black",fontWeight:"normal",fontSize:14}},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",x:"right",data:["正常","报警"]},series:[{name:"设备状态",type:"pie",radius:["70%","50%"],center:["50%","55%"],avoidLabelOverlap:!1,label:{normal:{show:!1,position:"center"},emphasis:{show:!0,textStyle:{fontSize:"20",fontWeight:"bold"}}},labelLine:{normal:{show:!1}},color:["#00e210","#f34747"],data:[{value:i.normal,name:"正常"},{value:i.alarm,name:"报警"}]}]};t.DeviceStateAnalysis.setOption(s),t.DeviceStateAnalysis.hideLoading()}})},drawWeek:function(){var t=this;this.AlarmRanking=echarts.init(document.getElementById("WeekAlarmAnalysis"),"macarons"),this.AlarmRanking.showLoading();var e=sessionStorage.getItem("token");this.fn.GetWeekAlarmAnalysis(e).then(function(e){var a=JSON.parse(e);if("0"==a.code){var i=a.info,s={title:{text:" 近7天电气火灾设备报警量分析",padding:[15,20,0,40],textStyle:{color:"black",fontWeight:"normal",fontSize:14}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},backgroundColor:"#fff",color:["#f4d400","#f48400","#0073f4"],legend:{data:[{name:"漏电"},{name:"超温"},{name:"过载"}],bottom:10},xAxis:{data:i.Date},yAxis:{type:"value"},toolbox:{show:!0,feature:{magicType:{type:["line","bar"]},dataView:{readOnly:!0}},right:30,top:10},series:[{name:"漏电",type:"bar",stack:"总量",data:i.LD},{name:"超温",type:"bar",stack:"总量",data:i.CW},{name:"过载",type:"bar",stack:"总量",data:i.GZ}]};t.AlarmRanking.setOption(s),t.AlarmRanking.hideLoading()}else"10"==a.code&&(alert("登陆状态失效,请重新登录！"),t.$router.push({name:"login"}));t.TopAlarm=i.TopAlarm,t.TopOffline=i.TopOffline,t.drawRanking1(),t.drawRanking2()})},drawType:function(){var t=this;this.WeekAlarmTypeAnalysis=echarts.init(document.getElementById("WeekAlarmTypeAnalysis")),this.WeekAlarmTypeAnalysis.showLoading();var e=sessionStorage.getItem("token");this.fn.GetWeekAlarmType(e).then(function(e){var a=JSON.parse(e);if("0"==a.code){var i=a.info,s={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: ({d}%)"},backgroundColor:"#fff",title:{text:" 近7天电气火灾设备报警类型分析",padding:[15,20,0,40],textStyle:{color:"black",fontWeight:"normal",fontSize:14}},legend:{orient:"vertical",x:"right",data:["漏电","超温","过载","烟雾"]},series:[{name:"设备状态",type:"pie",radius:["70%","50%"],center:["50%","55%"],avoidLabelOverlap:!1,label:{normal:{show:!1,position:"center"},emphasis:{show:!0,textStyle:{fontSize:"20",fontWeight:"bold"}}},labelLine:{normal:{show:!1}},color:["#f4d400","#f48400","#0073f4","#451565"],data:[{value:i.LD,name:"漏电"},{value:i.CW,name:"超温"},{value:i.GZ,name:"过载"},{value:i.YW,name:"烟雾"}]}]};t.WeekAlarmTypeAnalysis.setOption(s),t.WeekAlarmTypeAnalysis.hideLoading()}})},drawRanking1:function(){this.TopOfflineChats=echarts.init(document.getElementById("TopOffline"));for(var t=[],e=[],a=0;a<this.TopOffline.length;a++)t.push(this.TopOffline[a].num),e.push(this.TopOffline[a].Name);var i={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(t){return"设备："+e[t[0].dataIndex]+"<br/>离线次数："+t[0].value+"次"}},backgroundColor:"#fff",title:{text:" 近7天离线最多",padding:[15,20,0,40],textStyle:{color:"black",fontWeight:"normal",fontSize:14}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"value",axisLine:{show:!1},axisTick:{show:!1}},yAxis:{type:"category",data:[1,2,3,4,5,6,7],splitLine:{show:!1},axisLine:{show:!1},axisTick:{show:!1},nameTextStyle:{fontSize:15}},series:[{name:"离线次数",type:"bar",data:t,barWidth:14,barGap:10,smooth:!0,label:{normal:{show:!0,position:"right",offset:[-3,-2],textStyle:{color:"#F68300",fontSize:13}}},itemStyle:{emphasis:{barBorderRadius:7},normal:{barBorderRadius:7,color:new echarts.graphic.LinearGradient(0,0,1,0,[{offset:0,color:"#3977E6"},{offset:1,color:"#37BBF8"}])}}}]};this.TopOfflineChats.setOption(i)},drawRanking2:function(){this.TopAlarmCharts=echarts.init(document.getElementById("TopAlarm"));for(var t=[],e=[],a=0;a<this.TopAlarm.length;a++)t.push(this.TopAlarm[a].num),e.push(this.TopAlarm[a].DID);var i={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(t){return"设备："+e[t[0].dataIndex]+"<br/>报警次数："+t[0].value+"次"}},backgroundColor:"#fff",title:{text:" 近7天报警最多",padding:[15,20,0,40],textStyle:{color:"black",fontWeight:"normal",fontSize:14}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"value",axisLine:{show:!1},axisTick:{show:!1}},yAxis:{type:"category",data:[1,2,3,4,5,6,7],splitLine:{show:!1},axisLine:{show:!1},axisTick:{show:!1},nameTextStyle:{fontSize:15}},series:[{name:"报警次数",type:"bar",data:t,barWidth:14,barGap:10,smooth:!0,label:{normal:{show:!0,position:"right",offset:[-3,-2],textStyle:{color:"#F68300",fontSize:13}}},itemStyle:{emphasis:{barBorderRadius:7},normal:{barBorderRadius:7,color:new echarts.graphic.LinearGradient(0,0,1,0,[{offset:0,color:"#3977E6"},{offset:1,color:"#37BBF8"}])}}}]};this.TopAlarmCharts.setOption(i)}}},o={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("main",{staticClass:"site-page mianScreen ",staticStyle:{"text-align":"left"}},[e("div",{staticClass:"page-content container-fluid",staticStyle:{"margin-bottom":"70px","margin-top":"50px"}},[e("div",{staticClass:"row",attrs:{"data-plugin":"matchHeight","data-by-row":"true"}},[e("div",{staticClass:"col-xlg-6 col-sm-12"},[e("div",{staticClass:"widget widget-shadow",attrs:{id:"WeekAlarmAnalysis"}})]),this._v(" "),e("div",{staticClass:"col-xlg-3 col-lg-6 col-sm-12 marginT20"},[e("div",{staticClass:"widget widget-shadow",staticStyle:{height:"260px","margin-bottom":"8px"},attrs:{id:"TopOffline"}}),this._v(" "),e("div",{staticClass:"widget widget-shadow",staticStyle:{height:"260px"},attrs:{id:"TopAlarm"}})]),this._v(" "),e("div",{staticClass:"col-xlg-3 col-lg-6 col-sm-12 marginT20"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-lg-12 col-sm-6"},[e("div",{staticClass:"widget widget-shadow",staticStyle:{height:"260px","margin-bottom":"8px"},attrs:{id:"DeviceStateAnalysis"}})]),this._v(" "),e("div",{staticClass:"col-lg-12 col-sm-6"},[e("div",{staticClass:"widget widget-shadow",staticStyle:{height:"260px"},attrs:{id:"WeekAlarmTypeAnalysis"}})])])])])])])}]};var n=a("vSla")(s,o,!1,function(t){a("hJOE")},"data-v-7e5aecc0",null);e.default=n.exports}});
//# sourceMappingURL=29.2f33becb645e43054c29.js.map